##! Please refer to the documentation at
##! https://coreruleset.org/docs/development/regexp_assemble/.

##! Word list for rule 932220 (RCE Unix command injection)
##!
##! This list comes from (and should be in sync) the `unix-shell.data` file.

##! Not all of the prefixes for the command words will be legal.
##! We've decided to use the same prefix as in 932100 and 932105 here,
##! because we don't know exactly what things are possible after a pipe and
##! we don't want to overcomplicate things by introducing another prefix variation.
##! Not all of the prefixes matched by the expression will actually be valid.

##!+ i

##!^ .\|

##! starting tokens prefix
##!> assemble
\s*
##! time ifconfig
  ##!> cmdline unix
time
  ##!<
##! ;ifconfig
;
##! {ifconfig}
\{
##! |ifconfig
\|
##! ||ifconfig
\|\|
##! &ifconfig
&
##! & &ifconfig
&&
##! ;\nifconfig
\n
##! ;\rifconfig
\r
##! $(ifconfig)
\$\(
##! $((ifconfig))
\$\(\(
##! `ifconfig`
`
##! ${ifconfig}
\${
##! <( ifconfig )
<\(
##! >( ifconfig )
>\(
##! a() ( ifconfig; ); a
\(\s*\)
##!=>

##! match possible white space between prefix expressions
\s*
##!=>

##! commands prefix
(?:
##!=>

##! { ifconfig }
\{
##! ( ifconfig )
\s*\(\s*
##! VARNAME=xyz ifconfig
\w+=(?:[^\s]*|\$.*|\$.*|<.*|>.*|\'.*\'|\".*\")\s+
##! ! ifconfig
!\s*
##! $ifconfig
\$
##!=>

)*
##!=>

##! match possible white space between prefix expressions
\s*
##!=>

##! quoting prefix
(?:
##!=>

##! 'ifconfig'
'
##! "ifconfig"
\"
##!=>

)*
##!=>

##! paths prefix (+ evasion prevention suffix [\x5c'\"]*)
(?:[\?\*\[\]\(\)\-\|+\w'\"\./\x5c]+/)?[\x5c'\"]*
##!=>

  ##!> cmdline unix

7z
7za
7zr
ab
adduser
agetty
alias
alpine
ansible-playbook
apt-get
apt
ar
arch
aria2c
arj
arp
as
ascii-xfr
ascii85
ash
aspell
at
atobm
awk
aws
base32
base64
basenc
bash
batch
bpftrace
breaksw
bridge
bsdcat
bsdiff
bsdtar
builtin
bundler
busctl
busybox
byebug
bzcat
bzdiff
bzegrep
bzfgrep
bzgrep
bzip2
bzless
bzmore
c89
c99
cancel
capsh
cat
cc
certbot
chattr
chdir
check_by_ssh
check_cups
check_log
check_memory
check_raid
check_ssl_cert
check_statusfile
chflags
chmod
choom
chown
chroot
cmp
cobc
column
comm
command
composer
compress
coproc
cowsay
cowthink
cp
cpan
cpio
cpulimit
crash
crontab
csh
csplit
csvtool
cupsfilter
curl
cut
dash
date
dd
dhclient
dialog
diff
dig
dmesg
dmidecode
dmsetup
dnf
doas
docker
done
dosbox
dpkg
du
dvips
easy_install
eb
echo
ed
efax
egrep
emacs
endif
endsw
env
env-update
eqn
esac
eval
ex
exec
exiftool
expand
expect
export
expr
facter
fc
fetch
fgrep
fi
file
filetest
find
finger
fish
flock
fmt
fold
foreach
fping
ftp
ftpstats
ftpwho
function
gawk
gcc
gcore
gdb
gem
genie
genisoimage
GET
getfacl
ghc
ghci
gimp
ginsh
git
go
grc
grep
gtester
gunzip
gzcat
gzip
hd
head
hexdump
highlight
history
hostid
hostname
hping3
htdigest
htpasswd
hup
iconv
##! 'id' causes way too much FP, so we require whitespace; this will allow
##! injecting ';id' unfortunately.
id
ifconfig
iftop
install
ionice
ip
ip6tables
ipconfig
iptables
irb
ispell
java
jexec
jjs
jobs
join
journalctl
jq
jrunscript
kill
killall
knife
ksh
ksshell
last
lastcomm
lastlog
lastlogin
latex
ld
ldconfig
ldd
less
lessecho
lessfile
lesspipe
lftp
lftpget
links
ln
local
locate
loginctl
logname
logsave
look
lp
ls
ls-F
lsb_release
lscpu
lshw
lsmod
lsof
lspci
lsusb
ltrace
lua
lualatex
luatex
lwp-download
lwp-dump
lwp-mirror
lwp-request
lynx
lzcat
lzcmp
lzdiff
lzegrep
lzfgrep
lzgrep
lzless
lzma
lzmore
mail
mailq
mailx
make
man
mawk
mkdir
mlocate
more
mosquitto
mount
msgattrib
msgcat
msgconv
msgfilter
msgmerge
msguniq
mtr
mutt
mv
mysql
mysqladmin
mysqldump
mysqldumpslow
mysqlhotcopy
mysqlshow
nano
nasm
nawk
nc.openbsd
nc.traditional
nc
ncat
neofetch
net
netcat
netkit-ftp
netstat
nice
nl
nm
nmap
node
nohup
nping
npm
nroff
nsenter
nslookup
nstat
octave
od
onintr
openssl
openvpn
openvt
opkg
passwd
paste
patch
pax
pdb
pdflatex
pdftex
perf
perl
perl5
perlsh
perms
pf
pftp
pg
pgrep
php
pic
pico
pidstat
ping
pip
pkexec
pkg
pkg_info
pkginfo
pkill
popd
pr
printenv
printf
pry
ps
psftp
psql
ptar
ptardiff
ptargrep
ptx
python
puppet
pushd
rake
raku
rar
rcp
readelf
realpath
red
redcarpet
rename
repeat
replace
restic
rev
rlogin
rlwrap
rm
rmdir
rmuser
rnano
route
rpm
rpmdb
rpmquery
rpmverify
rsync
ruby
run-mailcap
run-parts
rview
rvim
sash
sched
scp
screen
script
sdiff
sed
sendmail
service
set
setarch
setenv
setfacl
setsid
sftp
sg
sh.distrib
sh
shuf
shutdown
sleep
slsh
smbclient
snap
socat
soelim
sort
source
split
sqlite3
ss
ssh
ssh-keygen
ssh-keyscan
sshpass
start-stop-daemon
stdbuf
strace
strings
su
sudo
svn
sysctl
systemctl
systemd-resolve
tac
tail
tailf
tar
task
taskset
tbl
tclsh
tcpdump
tcping
tcptraceroute
tcsh
tee
telnet
tex
tftp
tic
time
timedatectl
timeout
tmux
top
touch
traceroute
traceroute6
troff
tshark
ul
ulimit
uname
uncompress
unexpand
uniq
unlink
unlzma
unrar
unset
unshare
unxz
unzip
update-alternatives
useradd
userdel
usermod
uudecode
uuencode
valgrind
vi
view
vigr
vim
vimdiff
vipw
virsh
volatility
w3m
wall
watch
wc
wget
whiptail
who
whoami
whois
wireshark
wish
xargs
xelatex
xetex
xmodmap
xmore
xpad
xterm
xxd
xz
xzcat
xzcmp
xzdec
xzdiff
xzegrep
xzfgrep
xzgrep
xzless
xzmore
yarn
yelp
yum
zathura
zcat
zcmp
zdiff
zegrep
zfgrep
zgrep
zip
zless
zmore
zrun
zsh
zsoelim
zypper
  ##!<
